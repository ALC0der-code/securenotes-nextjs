"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[243],{6243:function(e,s,t){t.r(s),t.d(s,{VaultContent:function(){return J}});var a=t(5444),r=t(9300),l=t(4018),i=t(5522);let n=l.fC,o=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.aV,{ref:t,className:(0,i.cn)("inline-flex h-10 items-center justify-center rounded-lg bg-gray-100 p-1 text-gray-600",e),...s}));o.displayName=l.aV.displayName;let c=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.xz,{ref:t,className:(0,i.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-md px-3 py-1.5 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-white data-[state=active]:text-gray-900 data-[state=active]:shadow-sm",e),...s}));c.displayName=l.xz.displayName;let d=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(l.VY,{ref:t,className:(0,i.cn)("mt-2 ring-offset-white focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2",e),...s}));d.displayName=l.VY.displayName;var m=t(6771),u=t(691),h=t(6124),x=t(5762),p=t(5076),y=t(9429),g=t(6237),f=t(563),w=t(2422),j=t(4678);let N=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("textarea",{className:(0,i.cn)("flex min-h-[80px] w-full rounded-lg border border-gray-300 bg-white px-3 py-2 text-sm ring-offset-white placeholder:text-gray-500 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-blue-600 focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:t,...s}));N.displayName="Textarea";var v=t(4635);let b=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("rounded-2xl border border-gray-100 bg-white shadow-sm",e),...s}));b.displayName="Card",r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...s})).displayName="CardHeader",r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("h3",{ref:t,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...s})).displayName="CardTitle",r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("p",{ref:t,className:(0,i.cn)("text-sm text-gray-600",e),...s})).displayName="CardDescription",r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("p-6 pt-0",e),...s})).displayName="CardContent",r.forwardRef(({className:e,...s},t)=>(0,a.jsx)("div",{ref:t,className:(0,i.cn)("flex items-center p-6 pt-0",e),...s})).displayName="CardFooter";var C=t(9095),S=t(3485);let A=C.fC,k=C.xz,z=C.h_;C.x8;let I=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(C.aV,{ref:t,className:(0,i.cn)("fixed inset-0 z-50 bg-black/50 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s}));I.displayName=C.aV.displayName;let E=r.forwardRef(({className:e,children:s,...t},r)=>(0,a.jsxs)(z,{children:[(0,a.jsx)(I,{}),(0,a.jsxs)(C.VY,{ref:r,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border border-gray-200 bg-white p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-2xl",e),...t,children:[s,(0,a.jsxs)(C.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-white transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-gray-100",children:[(0,a.jsx)(S.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Close"})]})]})]}));E.displayName=C.VY.displayName;let D=({className:e,...s})=>(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-1.5 text-center sm:text-left",e),...s});D.displayName="DialogHeader";let F=r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(C.Dx,{ref:t,className:(0,i.cn)("text-lg font-semibold leading-none tracking-tight",e),...s}));F.displayName=C.Dx.displayName,r.forwardRef(({className:e,...s},t)=>(0,a.jsx)(C.dk,{ref:t,className:(0,i.cn)("text-sm text-gray-600",e),...s})).displayName=C.dk.displayName;var Z=t(1585),_=t(300),L=t(5486);_.Z.plugin(L.Z);class P{static{this.localDB=null}static{this.remoteDB=null}static{this.syncHandler=null}static async initialize(e){this.localDB=new _.Z(`securenotes_${e}`),this.remoteDB=new _.Z("https://admin:SecurePass123!@securenotes-couchdb.fly.dev/securenotes");try{await this.localDB.createIndex({index:{fields:["userId"]}})}catch(e){console.error("Error creating index:",e)}this.syncHandler=this.localDB.sync(this.remoteDB,{live:!0,retry:!0,filter:s=>s.userId===e}).on("change",e=>{console.log("Sync change:",e)}).on("error",e=>{console.error("Sync error:",e)})}static async addItem(e){if(!this.localDB)throw Error("Database not initialized");let s=new Date().toISOString(),t={...e,_id:`${e.type}_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,createdAt:s,updatedAt:s};return await this.localDB.put(t),t}static async updateItem(e){if(!this.localDB)throw Error("Database not initialized");let s={...e,updatedAt:new Date().toISOString()};await this.localDB.put(s)}static async deleteItem(e,s){if(!this.localDB)throw Error("Database not initialized");await this.localDB.remove(e,s)}static async getItems(e,s){if(!this.localDB)throw Error("Database not initialized");let t={userId:e};return s&&(t.type=s),(await this.localDB.find({selector:t,sort:[{updatedAt:"desc"}]})).docs}static async searchItems(e,s){if(!this.localDB)throw Error("Database not initialized");return(await this.getItems(e)).filter(e=>e.title.toLowerCase().includes(s.toLowerCase()))}static destroy(){this.syncHandler&&(this.syncHandler.cancel(),this.syncHandler=null),this.localDB=null,this.remoteDB=null}}class R{static async getKey(e,s){let t=new TextEncoder,a=await crypto.subtle.importKey("raw",t.encode(e),{name:"PBKDF2"},!1,["deriveBits","deriveKey"]);return crypto.subtle.deriveKey({name:"PBKDF2",salt:s,iterations:1e5,hash:"SHA-256"},a,{name:"AES-GCM",length:256},!1,["encrypt","decrypt"])}static async encrypt(e,s){try{let t=new TextEncoder,a=crypto.getRandomValues(new Uint8Array(16)),r=crypto.getRandomValues(new Uint8Array(12)),l=await this.getKey(s,a),i=await crypto.subtle.encrypt({name:"AES-GCM",iv:r},l,t.encode(e)),n=new Uint8Array(a.length+r.length+i.byteLength);return n.set(a,0),n.set(r,a.length),n.set(new Uint8Array(i),a.length+r.length),btoa(String.fromCharCode(...n))}catch(e){throw console.error("Encryption error:",e),Error("Failed to encrypt data")}}static async decrypt(e,s){try{let t=Uint8Array.from(atob(e),e=>e.charCodeAt(0)),a=t.slice(0,16),r=t.slice(16,28),l=t.slice(28),i=await this.getKey(s,a),n=await crypto.subtle.decrypt({name:"AES-GCM",iv:r},i,l);return new TextDecoder().decode(n)}catch(e){throw console.error("Decryption error:",e),Error("Failed to decrypt data. Check your master password.")}}static generatePassword(e=16){let s="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!@#$%^&*()_+-=[]{}|;:,.<>?",t=new Uint8Array(e);return crypto.getRandomValues(t),Array.from(t).map(e=>s[e%s.length]).join("")}}function B(){let{data:e}=(0,x.useSession)()||{},[s,t]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,h]=(0,r.useState)(""),[C,S]=(0,r.useState)(""),[z,I]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e?.user?.id&&_()},[e?.user?.id]);let _=async()=>{try{await P.initialize(e?.user?.id??""),await L()}catch(e){console.error("Error initializing:",e),Z.A.error("Failed to initialize database")}finally{I(!1)}},L=async()=>{try{let s=await P.getItems(e?.user?.id??"","note");t(s)}catch(e){console.error("Error loading notes:",e),Z.A.error("Failed to load notes")}},B=async()=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.encrypt(C,s);c?(await P.updateItem({...c,title:u,encryptedContent:t}),Z.A.success("Note updated successfully!")):(await P.addItem({userId:e?.user?.id??"",type:"note",title:u,encryptedContent:t}),Z.A.success("Note created successfully!")),await L(),V()}catch(e){console.error("Error saving note:",e),Z.A.error("Failed to save note")}},U=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s);d(e),h(e.title),S(t),o(!0)}catch(e){console.error("Error decrypting note:",e),Z.A.error("Failed to decrypt note")}},O=async e=>{if(confirm("Are you sure you want to delete this note?"))try{await P.deleteItem(e._id,e._rev??""),Z.A.success("Note deleted successfully!"),await L()}catch(e){console.error("Error deleting note:",e),Z.A.error("Failed to delete note")}},V=()=>{o(!1),d(null),h(""),S("")},M=l?s.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())):s;return z?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading notes..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsx)(j.I,{placeholder:"Search notes...",value:l,onChange:e=>i(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(A,{open:n,onOpenChange:o,children:[(0,a.jsx)(k,{asChild:!0,children:(0,a.jsxs)(w.z,{onClick:()=>{d(null),h(""),S("")},className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:[(0,a.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"New Note"]})}),(0,a.jsxs)(E,{className:"max-w-2xl",children:[(0,a.jsx)(D,{children:(0,a.jsx)(F,{children:c?"Edit Note":"Create New Note"})}),(0,a.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"title",children:"Title"}),(0,a.jsx)(j.I,{id:"title",placeholder:"Enter note title",value:u,onChange:e=>h(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"content",children:"Content"}),(0,a.jsx)(N,{id:"content",placeholder:"Enter note content (will be encrypted)",value:C,onChange:e=>S(e.target.value),rows:10})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(w.z,{variant:"outline",onClick:V,children:"Cancel"}),(0,a.jsx)(w.z,{onClick:B,disabled:!u||!C,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:c?"Update":"Create"})]})]})]})]})]}),0===M.length?(0,a.jsxs)("div",{className:"text-center py-16 bg-white rounded-2xl border border-gray-100",children:[(0,a.jsx)(m.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No notes yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Create your first encrypted note to get started"})]}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:M.map(e=>(0,a.jsxs)(b,{className:"p-6 hover:shadow-lg transition-shadow cursor-pointer group",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-3",children:(0,a.jsx)("h3",{className:"font-semibold text-lg text-gray-900 line-clamp-2",children:e.title})}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Updated: ",new Date(e.updatedAt).toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(w.z,{size:"sm",variant:"outline",onClick:()=>U(e),className:"flex-1",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 mr-1"}),"Edit"]}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>O(e),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]})]},e._id))})]})}var U=t(2429),O=t(8082),V=t(1471),M=t(1804);function T(){let{data:e}=(0,x.useSession)()||{},[s,t]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[m,h]=(0,r.useState)(""),[N,C]=(0,r.useState)(""),[S,z]=(0,r.useState)(""),[I,_]=(0,r.useState)(""),[L,B]=(0,r.useState)(""),[T,H]=(0,r.useState)(!1),[K,J]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e?.user?.id&&Y()},[e?.user?.id]);let Y=async()=>{try{await P.initialize(e?.user?.id??""),await G()}catch(e){console.error("Error initializing:",e),Z.A.error("Failed to initialize database")}finally{J(!1)}},G=async()=>{try{let s=await P.getItems(e?.user?.id??"","password");t(s)}catch(e){console.error("Error loading passwords:",e),Z.A.error("Failed to load passwords")}},$=async()=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.encrypt(JSON.stringify({username:N,password:S,website:I,notes:L}),s);c?(await P.updateItem({...c,title:m,encryptedContent:t}),Z.A.success("Password updated successfully!")):(await P.addItem({userId:e?.user?.id??"",type:"password",title:m,encryptedContent:t}),Z.A.success("Password created successfully!")),await G(),Q()}catch(e){console.error("Error saving password:",e),Z.A.error("Failed to save password")}},W=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s),a=JSON.parse(t);d(e),h(e.title),C(a.username),z(a.password),_(a.website),B(a.notes),o(!0)}catch(e){console.error("Error decrypting password:",e),Z.A.error("Failed to decrypt password")}},q=async e=>{if(confirm("Are you sure you want to delete this password?"))try{await P.deleteItem(e._id,e._rev??""),Z.A.success("Password deleted successfully!"),await G()}catch(e){console.error("Error deleting password:",e),Z.A.error("Failed to delete password")}},Q=()=>{o(!1),d(null),h(""),C(""),z(""),_(""),B(""),H(!1)},X=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s),a=JSON.parse(t);await navigator.clipboard.writeText(a.password),Z.A.success("Password copied to clipboard!")}catch(e){console.error("Error copying password:",e),Z.A.error("Failed to copy password")}},ee=l?s.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())):s;return K?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading passwords..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsx)(j.I,{placeholder:"Search passwords...",value:l,onChange:e=>i(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(A,{open:n,onOpenChange:o,children:[(0,a.jsx)(k,{asChild:!0,children:(0,a.jsxs)(w.z,{onClick:()=>{d(null),h(""),C(""),z(""),_(""),B("")},className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:[(0,a.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"New Password"]})}),(0,a.jsxs)(E,{className:"max-w-2xl",children:[(0,a.jsx)(D,{children:(0,a.jsx)(F,{children:c?"Edit Password":"Create New Password"})}),(0,a.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"title",children:"Title / Service Name"}),(0,a.jsx)(j.I,{id:"title",placeholder:"e.g., Gmail, Netflix, Work Email",value:m,onChange:e=>h(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"website",children:"Website / URL"}),(0,a.jsx)(j.I,{id:"website",placeholder:"https://example.com",value:I,onChange:e=>_(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"username",children:"Username / Email"}),(0,a.jsx)(j.I,{id:"username",placeholder:"your@email.com",value:N,onChange:e=>C(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"password",children:"Password"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(j.I,{id:"password",type:T?"text":"password",placeholder:"Enter password",value:S,onChange:e=>z(e.target.value),className:"pr-10"}),(0,a.jsx)("button",{type:"button",onClick:()=>H(!T),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:T?(0,a.jsx)(U.Z,{className:"h-4 w-4"}):(0,a.jsx)(O.Z,{className:"h-4 w-4"})})]}),(0,a.jsx)(w.z,{type:"button",variant:"outline",onClick:()=>{z(R.generatePassword(16)),Z.A.success("Strong password generated!")},children:(0,a.jsx)(V.Z,{className:"h-4 w-4"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"notes",children:"Notes (Optional)"}),(0,a.jsx)(j.I,{id:"notes",placeholder:"Additional notes",value:L,onChange:e=>B(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(w.z,{variant:"outline",onClick:Q,children:"Cancel"}),(0,a.jsx)(w.z,{onClick:$,disabled:!m||!S,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:c?"Update":"Create"})]})]})]})]})]}),0===ee.length?(0,a.jsxs)("div",{className:"text-center py-16 bg-white rounded-2xl border border-gray-100",children:[(0,a.jsx)(u.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No passwords yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Store your first password securely"})]}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:ee.map(e=>(0,a.jsxs)(b,{className:"p-6 hover:shadow-lg transition-shadow group",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-3",children:(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("h3",{className:"font-semibold text-lg text-gray-900 line-clamp-1",children:e.title})})}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Updated: ",new Date(e.updatedAt).toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)(w.z,{size:"sm",variant:"outline",onClick:()=>X(e),className:"flex-1",children:[(0,a.jsx)(M.Z,{className:"h-4 w-4 mr-1"}),"Copy"]}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>W(e),children:(0,a.jsx)(g.Z,{className:"h-4 w-4"})}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>q(e),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]})]},e._id))})]})}var H=t(3394);function K(){let{data:e}=(0,x.useSession)()||{},[s,t]=(0,r.useState)([]),[l,i]=(0,r.useState)(""),[n,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[m,u]=(0,r.useState)(""),[N,C]=(0,r.useState)(""),[S,z]=(0,r.useState)(""),[I,_]=(0,r.useState)(!0);(0,r.useEffect)(()=>{e?.user?.id&&L()},[e?.user?.id]);let L=async()=>{try{await P.initialize(e?.user?.id??""),await B()}catch(e){console.error("Error initializing:",e),Z.A.error("Failed to initialize database")}finally{_(!1)}},B=async()=>{try{let s=await P.getItems(e?.user?.id??"","link");t(s)}catch(e){console.error("Error loading links:",e),Z.A.error("Failed to load links")}},U=async()=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.encrypt(JSON.stringify({url:N,description:S}),s);c?(await P.updateItem({...c,title:m,encryptedContent:t}),Z.A.success("Link updated successfully!")):(await P.addItem({userId:e?.user?.id??"",type:"link",title:m,encryptedContent:t}),Z.A.success("Link created successfully!")),await B(),J()}catch(e){console.error("Error saving link:",e),Z.A.error("Failed to save link")}},O=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s),a=JSON.parse(t);d(e),u(e.title),C(a.url),z(a.description),o(!0)}catch(e){console.error("Error decrypting link:",e),Z.A.error("Failed to decrypt link")}},V=async e=>{if(confirm("Are you sure you want to delete this link?"))try{await P.deleteItem(e._id,e._rev??""),Z.A.success("Link deleted successfully!"),await B()}catch(e){console.error("Error deleting link:",e),Z.A.error("Failed to delete link")}},T=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s),a=JSON.parse(t);window.open(a.url,"_blank","noopener,noreferrer")}catch(e){console.error("Error opening link:",e),Z.A.error("Failed to open link")}},K=async e=>{try{let s=sessionStorage.getItem("masterPassword");if(!s){Z.A.error("Master password not found");return}let t=await R.decrypt(e.encryptedContent,s),a=JSON.parse(t);await navigator.clipboard.writeText(a.url),Z.A.success("URL copied to clipboard!")}catch(e){console.error("Error copying URL:",e),Z.A.error("Failed to copy URL")}},J=()=>{o(!1),d(null),u(""),C(""),z("")},Y=l?s.filter(e=>e.title.toLowerCase().includes(l.toLowerCase())):s;return I?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,a.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading links..."})]}):(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 items-center justify-between",children:[(0,a.jsxs)("div",{className:"relative w-full sm:w-96",children:[(0,a.jsx)(p.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),(0,a.jsx)(j.I,{placeholder:"Search links...",value:l,onChange:e=>i(e.target.value),className:"pl-10"})]}),(0,a.jsxs)(A,{open:n,onOpenChange:o,children:[(0,a.jsx)(k,{asChild:!0,children:(0,a.jsxs)(w.z,{onClick:()=>{d(null),u(""),C(""),z("")},className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:[(0,a.jsx)(y.Z,{className:"mr-2 h-4 w-4"}),"New Link"]})}),(0,a.jsxs)(E,{className:"max-w-2xl",children:[(0,a.jsx)(D,{children:(0,a.jsx)(F,{children:c?"Edit Link":"Create New Link"})}),(0,a.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"title",children:"Title"}),(0,a.jsx)(j.I,{id:"title",placeholder:"e.g., Important Documentation, Project Resources",value:m,onChange:e=>u(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"url",children:"URL"}),(0,a.jsx)(j.I,{id:"url",placeholder:"https://example.com",value:N,onChange:e=>C(e.target.value)})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(v._,{htmlFor:"description",children:"Description (Optional)"}),(0,a.jsx)(j.I,{id:"description",placeholder:"Add a description for this link",value:S,onChange:e=>z(e.target.value)})]}),(0,a.jsxs)("div",{className:"flex gap-3 justify-end",children:[(0,a.jsx)(w.z,{variant:"outline",onClick:J,children:"Cancel"}),(0,a.jsx)(w.z,{onClick:U,disabled:!m||!N,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:c?"Update":"Create"})]})]})]})]})]}),0===Y.length?(0,a.jsxs)("div",{className:"text-center py-16 bg-white rounded-2xl border border-gray-100",children:[(0,a.jsx)(h.Z,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No links yet"}),(0,a.jsx)("p",{className:"text-gray-600 mb-6",children:"Save your first important link"})]}):(0,a.jsx)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-3",children:Y.map(e=>(0,a.jsxs)(b,{className:"p-6 hover:shadow-lg transition-shadow group",children:[(0,a.jsx)("div",{className:"flex justify-between items-start mb-3",children:(0,a.jsx)("h3",{className:"font-semibold text-lg text-gray-900 line-clamp-1",children:e.title})}),(0,a.jsxs)("p",{className:"text-sm text-gray-500 mb-4",children:["Updated: ",new Date(e.updatedAt).toLocaleDateString()]}),(0,a.jsxs)("div",{className:"flex gap-2 flex-wrap",children:[(0,a.jsxs)(w.z,{size:"sm",variant:"outline",onClick:()=>T(e),className:"flex-1",children:[(0,a.jsx)(H.Z,{className:"h-4 w-4 mr-1"}),"Open"]}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>K(e),children:(0,a.jsx)(M.Z,{className:"h-4 w-4"})}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>O(e),children:(0,a.jsx)(g.Z,{className:"h-4 w-4"})}),(0,a.jsx)(w.z,{size:"sm",variant:"outline",onClick:()=>V(e),className:"text-red-600 hover:text-red-700 hover:bg-red-50",children:(0,a.jsx)(f.Z,{className:"h-4 w-4"})})]})]},e._id))})]})}function J(){let[e,s]=(0,r.useState)("notes");return(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Your Encrypted Vault"}),(0,a.jsx)("p",{className:"text-gray-600 mt-2",children:"All your data is encrypted and secure"})]}),(0,a.jsxs)(n,{value:e,onValueChange:s,className:"w-full",children:[(0,a.jsxs)(o,{className:"grid w-full max-w-md grid-cols-3 mb-8",children:[(0,a.jsxs)(c,{value:"notes",className:"flex items-center gap-2",children:[(0,a.jsx)(m.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Notes"})]}),(0,a.jsxs)(c,{value:"passwords",className:"flex items-center gap-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Passwords"})]}),(0,a.jsxs)(c,{value:"links",className:"flex items-center gap-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"hidden sm:inline",children:"Links"})]})]}),(0,a.jsx)(d,{value:"notes",children:(0,a.jsx)(B,{})}),(0,a.jsx)(d,{value:"passwords",children:(0,a.jsx)(T,{})}),(0,a.jsx)(d,{value:"links",children:(0,a.jsx)(K,{})})]})]})}}}]);